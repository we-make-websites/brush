<html>
  <head>
    <title>Communique</title>
  </head>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background-color: #f1f2f4;
      color: #1f2124;
      font-size: 16px;
      font-family: -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
      font-weight: 400;
      position: relative;
    }

    h1 {
      font-size: 1.25rem;
      font-weight: 600;
      line-height: 1.5rem;
    }

    h2 {
      font-size: 1rem;
      font-weight: 600;
      line-height: 1.5rem;
      margin-block-end: 1.25rem;
    }

    ul {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    a {
      border-radius: 0.25rem;
      color: #1f2124;
      display: block;
      font-size: 0.875rem;
      line-height: 125%;
      padding: 0.625rem 0.5rem;
      text-decoration: none;
    }

    a:hover {
      background-color: #f1f2f4;
    }

    strong {
      color: #616a75;
      display: block;
      font-size: 0.875rem;
      padding: 0.625rem 0.5rem;
      font-weight: 500;
    }

    .container {
      margin: 0 auto;
      max-width: 864px;
    }

    .header {
      align-items: center;
      border-bottom: 1px solid #dde0e4;
      display: flex;
      justify-content: space-between;
      margin-block-end: 2rem;
      padding: 1.25rem 0;
    }

    .dropdown {
      position: relative;
    }

    .button {
      appearance: none;
      background-color: #fff;
      border-radius: 0.25rem;
      border: 1px solid #abb1ba;
      box-shadow: 0rem 0.0625rem 0.0625rem #1f21241a;
      color: #1f2124;
      cursor: pointer;
      min-height: 2.25rem;
      min-width: 2.25rem;
      padding: calc((2.25rem - 1.25rem - 0.125rem) / 2) 1rem;
      padding-inline-end: calc(1rem - 6px);
    }

    .button__content {
      align-items: center;
      display: flex;
      font-family: -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
      font-size: 0.875rem;
      font-weight: 500;
      line-height: 1rem;
      gap: 0.25rem;
      pointer-events: none;
    }

    svg {
      fill: #616a75;
      height: 1.25rem;
      width: 1.25rem;
    }

    button:hover {
      background-color: #f1f2f4;
      outline: 1px solid #0000;
    }

    button:active {
      background-color: #ebecef;
      box-shadow: 0rem 0.0625rem 0.0625rem #1f21241a;
    }

    nav {
      background-color: #fff;
      border-radius: 0.5rem;
      box-shadow: 0rem 0.25rem 1.125rem -0.125rem #1f212414, 0rem 0.75rem 1.125rem -0.125rem #1f212426;
      margin-block-start: 5px;
      opacity: 0;
      padding: 0.625rem 0.5rem;
      pointer-events: none;
      position: absolute;
      right: 0;
      transition: opacity 100ms cubic-bezier(0.25,0.1,0.25,1), translate 100ms cubic-bezier(0.25,0.1,0.25,1);;
      translate: 0 -0.3125rem;
      width: max-content;
      z-index: 10;
    }

    nav.is-active {
      opacity: 1;
      pointer-events: auto;
      translate: 0;
    }

    .preview {
      background-color: #fff;
      border-radius: 0.5rem;
      box-shadow: 0rem 0.125rem 0.25rem #1f21241a, 0rem 0.0625rem 0.375rem #1f21240d;
      display: flex;
      flex-direction: column;
      margin-block-end: 2rem;
      max-height: calc(100vh - 142px);
      min-height: calc(100vh - 142px);
      padding: 1.25rem;
    }

    iframe {
      border: 1px solid #dde0e4;
      border-radius: 0.25rem;
      display: block;
      flex: 1;
      margin: 0 auto;
      width: 100%;
    }
  </style>

  <body>
    <div class="container">
      <div class="header">
        <h1>Email templates</h1>

        <div class="dropdown">
          <button
            class="button"
            js-nav="button"
          >
            <span class="button__content">
              <span>Template</span>

              <svg viewBox="0 0 20 20" focusable="false" aria-hidden="true"><path d="M13.098 8h-6.196c-.751 0-1.172.754-.708 1.268l3.098 3.432c.36.399 1.055.399 1.416 0l3.098-3.433c.464-.513.043-1.267-.708-1.267Z"></path></svg>
            </span>
          </button>

          <nav js-nav="dropdown">
            <%= groups %>
          </nav>
        </div>
      </div>

      <div class="preview">
        <h2>Preview</h2>

        <iframe
          title="Email preview"
          js-iframe="container"
        ></iframe>
      </div>
    </div>

    <script>
      function iframeHandler() {
        const nodeSelectors = {
          button: document.querySelector('[js-nav="button"]'),
          container: document.querySelector('[js-iframe="container"]'),
          dropdown: document.querySelector('[js-nav="dropdown"]'),
          link: [...document.querySelectorAll('[js-iframe="link"]')],
        }

        const url = new URL(location.href)

        /**
         * Read URL parameters.
         */
        const searchParams = new URLSearchParams(location.search)

        if (searchParams.get('page')) {
          const link = nodeSelectors.link.find((link) => {
            return link.dataset.page === searchParams.get('page')
          })

          nodeSelectors.container.src = link.href
        }

        /**
         * Add event listeners.
         */
        nodeSelectors.link.forEach((link) => {
          link.addEventListener('click', (event) => {
            event.preventDefault()
            nodeSelectors.container.src = event.target.href
            url.searchParams.set('page', event.target.dataset.page)
            history.replaceState(null, null, url);
          })
        })

        nodeSelectors.button.addEventListener('click', () => {
          nodeSelectors.dropdown.classList.toggle('is-active')
        })

        document.addEventListener('click', (event) => {
          if (event.target.matches('[js-nav="button"]')) {
            return
          }

          nodeSelectors.dropdown.classList.remove('is-active')
        })
      }

      iframeHandler()
    </script>
  </body>
</html>
